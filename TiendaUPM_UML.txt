@startuml
title "Diagrama de Clases - TiendaUPM"

package Comands {
    abstract class Comands {
        + apply()
    }
    abstract class ComandCash
    abstract class ComandClient
    abstract class ComandTicket
    abstract class Product
    class AddClient
    class ComandCashAdd
    class ComandCashList
    class ComandCashRemove
    class ComandCashTickets
    class ListClient
    class prodAdd
    class prodAddFood
    class prodAddMeeting
    class prodAddPer
    class prodList
    class prodRemove
    class prodUpdate
    class RemoveClient
    class TicketAdd
    class TicketNew
    class TicketPrint
    class TicketRemove
    class ComandEcho
    class ComandHelp
    class ComandsExit
    class UnknownComand
}
Comands <|.. ComandCash
Comands <|.. ComandClient
Comands <|.. ComandTicket
Comands <|.. Product
Comands <|.. ComandEcho
Comands <|.. ComandHelp
Comands <|.. ComandsExit
Comands <|.. UnknownComand

ComandClient <|.. AddClient
ComandClient <|.. ListClient
ComandClient <|.. RemoveClient

ComandCash <|.. ComandCashAdd
ComandCash <|.. ComandCashList
ComandCash <|.. ComandCashRemove
ComandCash <|.. ComandCashTickets

Product <|.. prodAdd
Product <|.. prodAddFood
Product <|.. prodAddMeeting
Product <|.. prodAddPer
Product <|.. prodList
Product <|.. prodRemove
Product <|.. prodUpdate


ComandTicket <|.. TicketAdd
ComandTicket <|.. TicketNew
ComandTicket <|.. TicketPrint
ComandTicket <|.. TicketRemove


'====================================================
' ENUMERACIONES
'====================================================
enum Category {
  + MERCH
  + STATIONERY
  + CLOTHES
  + BOOK
  + ELECTRONICS
  --
  - descuento : double
  + getDescuento() : double
}

enum TicketStatus {
  VACIO
  ACTIVO
  CERRADO
}

enum TypeEvent {
  COMIDA
  REUNION
  --
  - minDaysBefore : double
  + getMinDaysBefore() : double
}

'====================================================
' TIENDA Y ESTRUCTURA BASE
'====================================================
class TiendaUPM {
  - sc : Scanner
  - ticketActive : Ticket
  - catalog : Catalog
  - cashers : ArrayList<Cash>
  - clients : ArrayList<Client>
  - ticketList : ArrayList<Ticket>
  --
  + main(args : String[]) : void
  - init() : void
  - start() : void
  - gestionComandos(comand : String[]) : boolean
  - end() : void
}

TiendaUPM --> Catalog
TiendaUPM --> Cash : contiene >
TiendaUPM --> Client : contiene >
TiendaUPM --> Ticket : contiene >
TiendaUPM --> Comands : utiliza >

'====================================================
' CATALOGO Y PRODUCTOS
'====================================================
class Catalog {
  - products : Product[]
  - final MAX_NUM_PRODUCTS : int
  - num_products : int
  + Catalog()
  + length() : int
  + find(id : int) : Product
  + add(id : String, name : String, category : String, price : String) : void
  + addPer(id : String, name : String, category : String, price : String, pers : String) : void
  + addEvent(id : String, name : String, price : String, expiration_day : String, num_person : String, typeEvent : TypeEvent) : void
  + list() : void
  + update(id : String, change : String, value : String) : void
  + remove(id : String) : void
  + crearId() : String
}

class Product {
  - id : String
  - name : String
  - category : Category
  - price : Double
  - max_pers : int
  + Product(id : String, name : String, category : Category, price : Double)
  + Product(id : String, name : String, category : Category, price : Double, max_pers : int)
  + getID() : String
  + setId(id : String)
  + getName() : String
  + setName(name : String)
  + getCategory() : Category
  + setCategory(category : Category)
  + getPrice() : Double
  + setPrice(price : Double)
  + toString() : String
}

class Events extends Product {
  - expirationDate : String
  - final MAX_PARTICIPANTS=100
  - num_person : int
  - typeEvent : TypeEvent
  + Events(id : String, name : String, price : Double, expiration_day : String, num_person : int, typeEvent : TypeEvent)
  + check_min_time(date : String, typeEvent : TypeEvent) : boolean
  + getExpiration_day() : String
  + setExpiration_day(expiration_day : String)
  + getNum_person() : int
  + setNum_person(num_person : int)
}

Catalog --> Product : gestiona >

'====================================================
' TICKETS
'====================================================
class Ticket {
  - cart : Product[]
  - totalPrice : Double
  - totalDiscount : Double
  - final MAX_CART_PRODUCTS : int
  - productNumber : int
  + AddProduct(producto : Product) : void
  + RemoveProduct(producto : Product) : void
  + RemoveAll() : void
  + ToString() : String
}

Ticket --> Product
Ticket --> TicketStatus

'====================================================
' USUARIOS
'====================================================
abstract class User {
 - name : String
 - email : String
 +  User(name : String, email : String)
 + getName() : String
 + getEmail() : String
}

class Client extends User {
  - dni : String
  - cashId : Cash
  - clientTickets : List<Ticket>
  + Client (name : String, DNI : String, email : String, cashId : String)
  + getDNI() : String
  + getCashId() : String
  + toString() : String
  + getClientTickets() :  List<Ticket>
  + setClientTickets(clientTickets : List<Ticket>)
  + ticketAddClients(ticket : Ticket)
  + ticketListClientes
}

class Cash extends User {
  - id : String
  - cashTickets : List<Ticket>
  + Cash (id : String, name : String, email : String)
  + getId() : String
  + toString() : String
  + getCashTickets() : List<Ticket>
  + setCashTickets(cashTickets : List<Ticket>)
  + ticketAddCash(ticket Ticket)
  + ticketListCash()
}

User <|-- Client
User <|-- Cash

Client --> Ticket : posee >
Cash --> Ticket : crea >
Client --> Cash : creado_por >

Product --> Category
Events --> TypeEvent
@enduml